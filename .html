<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farming Station</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body class="bg-green-900 text-white min-h-screen font-sans">

    <!-- Navbar -->
    <nav class="bg-green-800 p-4 shadow-lg border-b border-green-700">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold text-yellow-400"><i class="fas fa-seedling mr-2"></i>Smart Farm Monitor</h1>
            <div id="status" class="text-xs px-2 py-1 rounded bg-red-500 animate-pulse">Connecting...</div>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8">
        
        <!-- AI Farming Assistant Banner -->
        <div class="bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-6 mb-8 border-l-8 border-yellow-400 shadow-2xl">
            <div class="flex flex-col md:flex-row items-center justify-between">
                <div class="mb-4 md:mb-0">
                    <h2 class="text-2xl font-bold text-yellow-300 mb-1"><i class="fas fa-robot mr-2"></i>Farming Assistant</h2>
                    <p class="text-slate-400 text-sm">Real-time analysis based on local weather</p>
                </div>
                <div class="bg-slate-700 px-6 py-3 rounded-lg w-full md:w-auto text-center">
                    <p id="advice" class="text-xl font-mono text-white font-bold tracking-wide">Analysing Data...</p>
                </div>
            </div>
        </div>

        <!-- Rain & Alert Status -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div id="rain-card" class="bg-slate-800 rounded-xl p-6 flex items-center justify-between shadow-lg transition-colors duration-500">
                <div>
                    <h3 class="text-slate-400">Rain Status</h3>
                    <p id="rain-status" class="text-3xl font-bold text-white">Detecting...</p>
                </div>
                <i id="rain-icon" class="fas fa-cloud text-5xl text-slate-500"></i>
            </div>
            
            <div class="bg-slate-800 rounded-xl p-6 flex items-center justify-between shadow-lg">
                <div>
                    <h3 class="text-slate-400">Time (IST)</h3>
                    <p id="timestamp" class="text-xl font-mono text-yellow-400">--:--:--</p>
                </div>
                <i class="fas fa-clock text-4xl text-slate-600"></i>
            </div>
        </div>

        <!-- Sensor Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">

            <!-- Temperature -->
            <div class="bg-green-800/50 rounded-lg p-4 text-center border border-green-700">
                <i class="fas fa-temperature-high text-orange-400 text-2xl mb-2"></i>
                <p class="text-slate-300 text-xs">Temperature</p>
                <p class="text-2xl font-bold"><span id="temp">--</span>Â°C</p>
            </div>

            <!-- Humidity -->
            <div class="bg-green-800/50 rounded-lg p-4 text-center border border-green-700">
                <i class="fas fa-water text-blue-400 text-2xl mb-2"></i>
                <p class="text-slate-300 text-xs">Humidity</p>
                <p class="text-2xl font-bold"><span id="humidity">--</span>%</p>
            </div>

            <!-- Pressure -->
            <div class="bg-green-800/50 rounded-lg p-4 text-center border border-green-700">
                <i class="fas fa-tachometer-alt text-purple-400 text-2xl mb-2"></i>
                <p class="text-slate-300 text-xs">Pressure</p>
                <p class="text-2xl font-bold"><span id="pressure">--</span>hPa</p>
            </div>

            <!-- Air Quality -->
            <div class="bg-green-800/50 rounded-lg p-4 text-center border border-green-700">
                <i class="fas fa-smog text-gray-400 text-2xl mb-2"></i>
                <p class="text-slate-300 text-xs">Air Quality</p>
                <p class="text-2xl font-bold" id="gas">--</p>
            </div>
        </div>
    </div>

    <script>
        // --- REPLACE THIS WITH YOUR FIREBASE CONFIG ---
       const firebaseConfig = {
         apiKey: "AIzaSyBJVMT3dLB1QZLbvsD2009hH5Szy2HvlUA",
         authDomain: "weather-station-b45a7.firebaseapp.com",
         projectId: "weather-station-b45a7",
         storageBucket: "weather-station-b45a7.firebasestorage.app",
         messagingSenderId: "751863040022",
         appId: "1:751863040022:web:35365b3e6d37dc3e1d0d37",
         measurementId: "G-MYE28Q0DXP"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        
        // Listen for data
        db.ref('weather/current').on('value', (snapshot) => {
            const data = snapshot.val();
            
            if (data) {
                // Connection Status
                document.getElementById('status').innerText = "System Online";
                document.getElementById('status').classList.remove('bg-red-500', 'animate-pulse');
                document.getElementById('status').classList.add('bg-green-500');

                // Basic Data
                document.getElementById('temp').innerText = data.temperature.toFixed(1);
                document.getElementById('humidity').innerText = data.humidity.toFixed(0);
                document.getElementById('pressure').innerText = data.pressure.toFixed(0);
                document.getElementById('gas').innerText = data.gas_level;
                document.getElementById('timestamp').innerText = data.timestamp;
                document.getElementById('advice').innerText = data.farming_advice || "Analyzing...";

                // Rain Logic (Assumes < 2500 is wet)
                const isRaining = data.rain_value < 2500;
                const rainCard = document.getElementById('rain-card');
                const rainText = document.getElementById('rain-status');
                const rainIcon = document.getElementById('rain-icon');

                if (isRaining) {
                    rainCard.classList.remove('bg-slate-800');
                    rainCard.classList.add('bg-blue-600', 'animate-pulse'); // Flash blue
                    rainText.innerText = "RAINING";
                    rainIcon.className = "fas fa-cloud-showers-heavy text-5xl text-white";
                } else {
                    rainCard.classList.remove('bg-blue-600', 'animate-pulse');
                    rainCard.classList.add('bg-slate-800');
                    rainText.innerText = "Dry";
                    rainIcon.className = "fas fa-sun text-5xl text-yellow-500";
                }
            }
        });
    </script>
</body>
</html>
